{% extends 'base.html' %}
{% block content %}
{% load comments %}
{% get_comment_list for gig as comment_list %}

<div class="container">
  <div class="row">
    <div class="col-md-8">
        <div class="row" style="padding-top:20px; padding-left:10px; padding-right:10px">
          <div class="panel panel-default">
        		<div class="panel-body">
          		<h3>{{gig.title}}</h3>
          		<p>Posted on {{gig.created}}</p>
              <p>Admins: 
                {% for admin in gig_admin %}
                  {{admin.person.username}}
                {% endfor %}
              </p>
              {% if admin %}
                <p><a href="/gigs/{{gig.pk}}/edit">Edit</a></p>
              {% endif %}
              <hr>
              <p>Starts on: {{gig.start_date.day}} / {{gig.start_date.month}} / {{gig.start_date.year}}</p>
              <p>End on: {{gig.end_date}}</p>
              <hr>
              {% if gig.description != None %}
                <p>{{gig.description}}</p>
              {% endif %}


              {% if membership_status == None %}
                <a href="/gigs/team_request/{{gig.pk}}" disabled='disabled' class="btn btn-default">Request pending</a>
              {% elif membership_status == True %}
                <!-- Should add functionality to allow users to leave gig's at some point, too-->
                <a href="#" class="btn btn-default" disabled='disabled'>You're a member!</a>
              {% else %}
                <a href="/gigs/team_request/{{gig.pk}}" class="btn btn-default">Request to join</a>
              {% endif %}   
        		</div>
      	  </div>
        </div>

        <div class="row" style="padding-top:20px; padding-left:10px; padding-right:10px">
          
          <div class="panel panel-default">
            <div class="panel-body">
              {% render_comment_form for gig %}
              {% render_comment_list for gig %}
              </div>
            </div>
          
        </div>
    </div>
    <div class="col-md-4">
        <div class="row" style="padding-top:20px; padding-left:10px; padding-right:10px"> 

          <div class="panel panel-default">
            <div class="panel-body">
              <p>Admin:</p>
                <ul class="avatar-list">
                  {% for admin in gig_admin %}
                  <li class="avatar-list-item">
                    {% if admin.person.person.picture.url != None %}
                      <a href="/people/profile/{{admin.person.person.pk}}"><img class="img-circle" src="{{admin.person.person.picture.url}}" alt="{{admin.person.person.fullname}}"></a>
                    {% else %}
                      <a href="/people/profile/{{admin.person.person.pk}}"><img class="img-circle" src="http://eadb.org/wp-content/uploads/2015/08/profile-placeholder.jpg" alt="{{admin.person.person.fullname}}"></a>
                    {% endif %}
                  </li>
                  {% endfor %}
                </ul>
              <p>Team</p>
              <ul class="avatar-list">
                {% for member in team %}
                 <li class="avatar-list-item">
                  {% if member.person.person.picture %}
                  <a href="/people/profile/{{member.person.person.pk}}"><img class="img-circle" src="{{member.person.person.picture.url}}" alt="{{member.person.person.fullname}}"></a>
                  {% else %}
                  <a href="/people/profile/{{member.person.person.pk}}"><img class="img-circle" src="http://eadb.org/wp-content/uploads/2015/08/profile-placeholder.jpg" alt="{{member.person.person.fullname}}"></a>
                  {% endif %}
                </li>
                {% endfor %}
              </ul>
            </div>
           </div>
        </div>
        <!-- Start profile block-->  
        {% if admin %}
        
        <div class="m-t">

          <div class="row" style="padding-top:20px">
            <div class="col-md-12">

              {% for request in membership_requests %}

              <div class="panel panel-default panel-profile">
                <div class="panel-body text-center">
                  <img class="panel-profile-img" src="{{request.person.person.picture.url}}">
                  <h5 class="panel-title">{{request.person.username}} has requested to join your gig!</h5>
                  <p class="m-b-md">{{request.person.person.bio}}</p>
                  <button class="btn btn-primary-outline btn-sm">
                    <span class="icon icon-add-user"></span> Accept
                  </button>
                  <button class="btn btn-primary-outline btn-sm">
                    <span class="icon icon-cross"></span> Reject
                  </button>                
                </div>
              </div>

              {% endfor %}

            </div>
          </div>
        </div>
        
        {% endif %}
        <!-- End profile block -->
    </div>
  </div>
</div>



{% endblock %}